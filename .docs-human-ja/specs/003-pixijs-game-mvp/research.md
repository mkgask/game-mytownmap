# 研究: PixiJS Game MVP

**機能**: PixiJS Game MVP | **日付**: 2026-02-01
**計画**: [specs/003-pixijs-game-mvp/plan.md](specs/003-pixijs-game-mvp/plan.md)

## 概要

基本的なPixiJSゲームキャンバスとレンダリング環境を実装するための最適なアプローチを決定するための研究を実施。将来のゲーム開発のための強固な基盤を提供する最小限の実行可能なセットアップに焦点を当てます。

## 技術的調査

### PixiJSバージョン選択

**検討したオプション:**
- PixiJS v7.x (最新安定版)
- PixiJS v6.x (LTS)

**決定**: PixiJS v7.x
- より良いTypeScriptサポートを備えたモダンAPI
- アクティブなメンテナンスとコミュニティ
- 現在のプロジェクト依存関係との互換性
- より良いパフォーマンスのためのWebGL2サポート

### キャンバスセットアップアプローチ

**オプション:**
1. 直接PixiJS Applicationインスタンス化
2. React-Pixi統合
3. Astroコンポーネントラッパー

**決定**: 直接PixiJS Application
- 最小限の依存関係 (追加のReact-Pixiなし)
- PixiJSライフサイクルに対する完全な制御
- ゲームレンダリングのためのより良いパフォーマンス
- Astroとのよりシンプルな統合

### テスト戦略

**ユニットテスト:**
- PixiJSオブジェクト用のDOM要素モック
- ゲームロジックの独立したテスト
- DOMシミュレーション用のHappyDOM

**統合テスト:**
- ブラウザ環境でのキャンバスレンダリングテスト
- PixiJSアプリケーションライフサイクルの検証
- メモリリークのチェック

**E2Eテスト:**
- 完全なブラウザテスト用のPlaywright
- キャンバスが表示されレンダリングされることの検証
- 基本的なユーザーインタラクションのテスト

## アーキテクチャ決定

### ゲーム構造

```
Game (メインクラス)
├── Renderer (PixiJSラッパー)
├── Scene (ステージコンテナ)
└── Canvas (DOM要素)
```

- ゲームロジックとレンダリングの懸念の分離
- 将来の機能拡張が容易
- テスト可能なコンポーネント

### パフォーマンス考慮事項

- PixiJSアプリケーションの遅延初期化
- コンポーネントアンマウント時の適切なクリーンアップ
- WebGLコンテキスト管理
- 長時間実行セッションでのメモリリーク防止

## 依存関係分析

**必要なパッケージ:**
- `pixi.js`: ^7.x - コアルレンダリングエンジン
- `@types/pixi.js`: TypeScript用の開発依存関係

**互換性:**
- Astro: ✅ 互換性あり
- Bun: ✅ バンドラーで動作
- HappyDOM: ⚠️ PixiJSオブジェクト用のカスタムモックが必要になる可能性

## リスク評価

**高リスク:**
- ターゲットブラウザでのWebGLサポート
- バンドラーとのPixiJSバージョンの互換性

**中リスク:**
- キャンバスのサイズとレスポンシブデザイン
- 長時間実行セッションでのメモリ管理

**低リスク:**
- 基本的なレンダリングセットアップ
- TypeScript統合

## 推奨事項

1. 基本的なPixiJS Applicationセットアップから開始
2. 適切なクリーンアップとエラーハンドリングを実装
3. 最初から包括的なテストを追加
4. 将来の拡張性 (シーン、アセットなど) を計画

## 次のステップ

- 基本的なGameCanvasコンポーネントの実装
- 適切な設定でのPixiJS Applicationのセットアップ
- 空のSceneコンテナの作成
- ユニットおよび統合テストの追加